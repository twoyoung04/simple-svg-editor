{"version":3,"file":"index.js","mappings":"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","sources":["webpack://svg-editor/./src/index.css","webpack://svg-editor/./node_modules/css-loader/dist/runtime/api.js","webpack://svg-editor/./node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://svg-editor/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://svg-editor/./node_modules/style-loader/dist/runtime/insertBySelector.js","webpack://svg-editor/./node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack://svg-editor/./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js","webpack://svg-editor/./node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack://svg-editor/./node_modules/style-loader/dist/runtime/styleTagTransform.js","webpack://svg-editor/webpack/bootstrap","webpack://svg-editor/webpack/runtime/compat get default export","webpack://svg-editor/webpack/runtime/define property getters","webpack://svg-editor/webpack/runtime/hasOwnProperty shorthand","webpack://svg-editor/webpack/runtime/nonce","webpack://svg-editor/./src/svgBoard/Vector.ts","webpack://svg-editor/./src/svgBoard/EventEmitter.ts","webpack://svg-editor/./src/svgBoard/Box.ts","webpack://svg-editor/./src/svgBoard/Transform.ts","webpack://svg-editor/./src/svgBoard/Area.ts","webpack://svg-editor/./src/svgBoard/namespaces.ts","webpack://svg-editor/./src/svgBoard/utilities.ts","webpack://svg-editor/./src/svgBoard/BaseElement.ts","webpack://svg-editor/./src/svgBoard/Constant.ts","webpack://svg-editor/./src/svgBoard/Ellipse.ts","webpack://svg-editor/./src/svgBoard/Rect.ts","webpack://svg-editor/./src/svgBoard/config.ts","webpack://svg-editor/./src/svgBoard/Manager.ts","webpack://svg-editor/./src/svgBoard/Selector.ts","webpack://svg-editor/./src/svgBoard/Log.ts","webpack://svg-editor/./src/svgBoard/Board.ts","webpack://svg-editor/./src/svgBoard/history.ts","webpack://svg-editor/./src/svgBoard/MouseStatusManager.ts","webpack://svg-editor/./src/svgBoard/ShortcutManager.ts","webpack://svg-editor/./src/index.css?cfe4","webpack://svg-editor/./src/index.ts"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"html,\\nbody {\\n  margin: 0;\\n  padding: 0;\\n}\\n\\n.cursor-crosshair {\\n  cursor: crosshair;\\n}\\n.cursor-pointer {\\n  cursor: pointer;\\n}\\n.cursor-default {\\n  cursor: default;\\n}\\n.cursor-grab {\\n  cursor: grab;\\n}\\n.cursor-resize {\\n  cursor: nwse-resize;\\n}\\n.cursor-move {\\n  cursor: move;\\n}\\n/* .cursor-rotate {\\n  cursor: url(rotate.svg), url(rotate.svg) 0s 0, progress;\\n} */\\n\\n/* @todo: change this */\\n.cursor-rotate {\\n  cursor: move;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/index.css\"],\"names\":[],\"mappings\":\"AAAA;;EAEE,SAAS;EACT,UAAU;AACZ;;AAEA;EACE,iBAAiB;AACnB;AACA;EACE,eAAe;AACjB;AACA;EACE,eAAe;AACjB;AACA;EACE,YAAY;AACd;AACA;EACE,mBAAmB;AACrB;AACA;EACE,YAAY;AACd;AACA;;GAEG;;AAEH,uBAAuB;AACvB;EACE,YAAY;AACd\",\"sourcesContent\":[\"html,\\nbody {\\n  margin: 0;\\n  padding: 0;\\n}\\n\\n.cursor-crosshair {\\n  cursor: crosshair;\\n}\\n.cursor-pointer {\\n  cursor: pointer;\\n}\\n.cursor-default {\\n  cursor: default;\\n}\\n.cursor-grab {\\n  cursor: grab;\\n}\\n.cursor-resize {\\n  cursor: nwse-resize;\\n}\\n.cursor-move {\\n  cursor: move;\\n}\\n/* .cursor-rotate {\\n  cursor: url(rotate.svg), url(rotate.svg) 0s 0, progress;\\n} */\\n\\n/* @todo: change this */\\n.cursor-rotate {\\n  cursor: move;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n\n      content += cssWithMappingToString(item);\n\n      if (needLayer) {\n        content += \"}\";\n      }\n\n      if (item[2]) {\n        content += \"}\";\n      }\n\n      if (item[4]) {\n        content += \"}\";\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n\n\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","\"use strict\";\n\nvar stylesInDOM = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDOM.length; i++) {\n    if (stylesInDOM[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var indexByIdentifier = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3],\n      supports: item[4],\n      layer: item[5]\n    };\n\n    if (indexByIdentifier !== -1) {\n      stylesInDOM[indexByIdentifier].references++;\n      stylesInDOM[indexByIdentifier].updater(obj);\n    } else {\n      var updater = addElementStyle(obj, options);\n      options.byIndex = i;\n      stylesInDOM.splice(i, 0, {\n        identifier: identifier,\n        updater: updater,\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction addElementStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n\n  var updater = function updater(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap && newObj.supports === obj.supports && newObj.layer === obj.layer) {\n        return;\n      }\n\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n\n  return updater;\n}\n\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDOM[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDOM[_index].references === 0) {\n        stylesInDOM[_index].updater();\n\n        stylesInDOM.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\nvar memo = {};\n/* istanbul ignore next  */\n\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n\n    memo[target] = styleTarget;\n  }\n\n  return memo[target];\n}\n/* istanbul ignore next  */\n\n\nfunction insertBySelector(insert, style) {\n  var target = getTarget(insert);\n\n  if (!target) {\n    throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n  }\n\n  target.appendChild(style);\n}\n\nmodule.exports = insertBySelector;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var element = document.createElement(\"style\");\n  options.setAttributes(element, options.attributes);\n  options.insert(element, options.options);\n  return element;\n}\n\nmodule.exports = insertStyleElement;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction setAttributesWithoutAttributes(styleElement) {\n  var nonce = typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n\n  if (nonce) {\n    styleElement.setAttribute(\"nonce\", nonce);\n  }\n}\n\nmodule.exports = setAttributesWithoutAttributes;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(styleElement, options, obj) {\n  var css = \"\";\n\n  if (obj.supports) {\n    css += \"@supports (\".concat(obj.supports, \") {\");\n  }\n\n  if (obj.media) {\n    css += \"@media \".concat(obj.media, \" {\");\n  }\n\n  var needLayer = typeof obj.layer !== \"undefined\";\n\n  if (needLayer) {\n    css += \"@layer\".concat(obj.layer.length > 0 ? \" \".concat(obj.layer) : \"\", \" {\");\n  }\n\n  css += obj.css;\n\n  if (needLayer) {\n    css += \"}\";\n  }\n\n  if (obj.media) {\n    css += \"}\";\n  }\n\n  if (obj.supports) {\n    css += \"}\";\n  }\n\n  var sourceMap = obj.sourceMap;\n\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  options.styleTagTransform(css, styleElement, options.options);\n}\n\nfunction removeStyleElement(styleElement) {\n  // istanbul ignore if\n  if (styleElement.parentNode === null) {\n    return false;\n  }\n\n  styleElement.parentNode.removeChild(styleElement);\n}\n/* istanbul ignore next  */\n\n\nfunction domAPI(options) {\n  var styleElement = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(styleElement, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(styleElement);\n    }\n  };\n}\n\nmodule.exports = domAPI;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction styleTagTransform(css, styleElement) {\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css;\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild);\n    }\n\n    styleElement.appendChild(document.createTextNode(css));\n  }\n}\n\nmodule.exports = styleTagTransform;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.nc = undefined;","import { Transform } from \"./Transform\"\n\nexport class Vector2 {\n  private _x: number\n  public get x(): number {\n    return this._x\n  }\n  public set x(value: number) {\n    this._x = value\n  }\n  private _y: number\n  public get y(): number {\n    return this._y\n  }\n  public set y(value: number) {\n    this._y = value\n  }\n  public get mod() {\n    return Math.sqrt(this.x * this.x + this.y * this.y)\n  }\n\n  constructor(x: number, y: number) {\n    this._x = x\n    this._y = y\n  }\n\n  public static ones() {\n    return new Vector2(1, 1)\n  }\n  public static zeros() {\n    return new Vector2(0, 0)\n  }\n  public add(v: Vector2) {\n    this._x += v.x\n    this._y += v.y\n    return this\n  }\n  public subtract(v: Vector2) {\n    this._x -= v.x\n    this._y -= v.y\n    return this\n  }\n  public dotMultiply(v: Vector2) {\n    this._x *= v.x\n    this._y *= v.y\n    return this\n  }\n\n  public crossMultiply(v: Vector2) {\n    return this._x * v.y - this._y * v.x\n  }\n\n  public angle(v: Vector2) {\n    return Math.acos(\n      Math.min((this._x * v.x + this._y * v.y) / this.mod / v.mod, 1)\n    )\n  }\n\n  public distance(v: Vector2) {\n    return Math.sqrt(Math.pow(this.x - v.x, 2) + Math.pow(this.y - v.y, 2))\n  }\n\n  public rotateAtOrigin(theta: number) {\n    let [x, y] = [\n      this.x * Math.cos(theta) - this.y * Math.sin(theta),\n      this.x * Math.sin(theta) + this.y * Math.cos(theta),\n    ]\n    this.x = x\n    this.y = y\n    return this\n  }\n\n  public applyTransform(transform: Transform) {\n    const { a, b, c, d, e, f } = transform\n    let [x, y] = [a * this.x + c * this.y + e, b * this.x + d * this.y + f]\n    this.x = x\n    this.y = y\n    return this\n  }\n\n  public opposite() {\n    return new Vector2(-this._x, -this._y)\n  }\n\n  public clone() {\n    return new Vector2(this.x, this.y)\n  }\n}\n","import { BaseElement } from \"./BaseElement\"\n\nexport class EventEmitter {\n  private callbacks: any\n\n  constructor() {\n    this.callbacks = {}\n  }\n\n  public on(name: EventType, callback: (e: BoardEvent) => void) {\n    const that = this\n\n    if (typeof name === \"undefined\") {\n      console.warn(\"wrong names\")\n      return false\n    }\n\n    if (typeof callback === \"undefined\") {\n      console.warn(\"wrong callback\")\n      return false\n    }\n\n    ;(that.callbacks[name] || (that.callbacks[name] = [])).push(callback)\n\n    return this\n  }\n\n  public off(name: EventType) {\n    if (typeof name === \"undefined\") {\n      console.warn(\"wrong name\")\n      return false\n    }\n\n    if (this.callbacks[name] instanceof Array) {\n      delete this.callbacks[name]\n    }\n\n    return this\n  }\n\n  public trigger(name: EventType, _args: any[]) {\n    if (typeof name === \"undefined\") {\n      console.warn(\"wrong name\")\n      return false\n    }\n    const args = !(_args instanceof Array) ? [] : _args\n\n    if (!this.callbacks[name]) return\n    this.callbacks[name].forEach((callback) => {\n      callback.apply(this, args)\n    })\n  }\n}\n\nexport enum EventType {\n  MouseDown = \"MouseDown\",\n  MouseMove = \"MouseMove\",\n  MouseUp = \"MouseUp\",\n  KeyDown = \"KeyDown\",\n  SelectStart = \"SelectStart\",\n  Selecting = \"Selecting\",\n  SelectEnd = \"SelectEnd\",\n  CreateStart = \"CreateStart\",\n  Creating = \"Creating\",\n  CreateEnd = \"CreateEnd\",\n  DragStart = \"DragStart\",\n  Draging = \"Draging\",\n  DragEnd = \"DragEnd\",\n  RotateStart = \"RotateStart\",\n  Rotating = \"Rotating\",\n  RotateEnd = \"RotateEnd\",\n  ScaleStart = \"ScaleStart\",\n  Scaling = \"Scaling\",\n  ScaleEnd = \"ScaleEnd\",\n  ChangeMode = \"ChangeMode\",\n  ElementSelected = \"ElementSelected\",\n  NothingSelected = \"NothingSelected\",\n  MouseStatusChange = \"MouseStatusChange\",\n\n  ElementChangeStart = \"ElementChangeStart\",\n  // 以下这两个事件主要用来区分普通操作和撤销时导致的元素变化区别\n  ElementChangeEnd = \"ElementChangeEnd\",\n  ElementChanged = \"ElementChanged\",\n\n  Undo = \"Undo\",\n  Redo = \"Redo\",\n}\n\nexport class BoardEvent {\n  private _elements: BaseElement[]\n  public get elements(): BaseElement[] {\n    return this._elements\n  }\n  public set elements(value: BaseElement[]) {\n    this._elements = value\n  }\n\n  private _name: string\n  public get name(): string {\n    return this._name\n  }\n  public set name(value: string) {\n    this._name = value\n  }\n  private _originEvent: Event\n  public get originEvent(): Event {\n    return this._originEvent\n  }\n  public set originEvent(value: Event) {\n    this._originEvent = value\n  }\n  private _customData: any\n  public get customData(): any {\n    return this._customData\n  }\n  public set customData(value: any) {\n    this._customData = value\n  }\n  constructor(name: string, event: Event) {\n    this.name = name\n    this.originEvent = event\n    this.elements = []\n  }\n}\n","import { Vector2 } from \"./Vector\"\n\nexport class Box {\n  private _x: number\n  public get x(): number {\n    return this._x\n  }\n  public set x(value: number) {\n    this._x = value\n  }\n  private _y: number\n  public get y(): number {\n    return this._y\n  }\n  public set y(value: number) {\n    this._y = value\n  }\n  private _w: number\n  public get w(): number {\n    return this._w\n  }\n  public set w(value: number) {\n    this._w = value\n  }\n  private _h: number\n  public get h(): number {\n    return this._h\n  }\n  public set h(value: number) {\n    this._h = value\n  }\n  public get x2(): number {\n    return this._x + this._w\n  }\n  public get y2(): number {\n    return this._y + this._h\n  }\n  constructor(x: number, y: number, w: number, h: number) {\n    this.x = x\n    this.y = y\n    this.w = w\n    this.h = h\n  }\n  public set(box: Box) {\n    this.x = box.x\n    this.y = box.y\n    this.w = box.w\n    this.h = box.h\n  }\n  public set4(x: number, y: number, w: number, h: number) {\n    this.x = x\n    this.y = y\n    this.w = w\n    this.h = h\n  }\n  public setSize(w: number, h: number) {\n    this.w = w\n    this.h = h\n  }\n  public clone() {\n    return new Box(this.x, this.y, this._w, this._h)\n  }\n  public merge(box: Box) {}\n  public static mergeAll(boxes: Box[]) {\n    if (boxes.length == 0) return null\n    if (boxes.length == 1) return boxes[0]\n    let minx = Math.min(...boxes.map((b) => b.x))\n    let maxx = Math.max(...boxes.map((b) => b.x + b.w))\n    let miny = Math.min(...boxes.map((b) => b.y))\n    let maxy = Math.max(...boxes.map((b) => b.y + b.h))\n    return new Box(minx, miny, maxx - minx, maxy - miny)\n  }\n\n  public center() {\n    return new Vector2(this.x + this.w / 2, this.y + this.h / 2)\n  }\n\n  public toVector2() {\n    return [\n      new Vector2(this.x, this.y),\n      new Vector2(this.x, this.y2),\n      new Vector2(this.x2, this.y2),\n      new Vector2(this.x2, this.y),\n    ]\n  }\n}\n","import { Vector2 } from \"./Vector\"\n\nexport class Transform {\n  public a: number\n  public b: number\n  public c: number\n  public d: number\n  public e: number\n  public f: number\n\n  public get rotation() {\n    // @todo: 未考虑缩放为负数的情况\n    let t = Math.acos(this.a / Math.sqrt(this.a * this.a + this.c * this.c))\n    return this.c > 0 ? Math.PI * 2 - t : t\n  }\n  public get rotationTransform() {\n    return Transform.fromAngle(this.rotation)\n  }\n\n  constructor(\n    a: number,\n    b: number,\n    c: number,\n    d: number,\n    e: number,\n    f: number\n  ) {\n    this.a = a\n    this.b = b\n    this.c = c\n    this.d = d\n    this.e = e\n    this.f = f\n  }\n\n  public static identity() {\n    return new Transform(1, 0, 0, 1, 0, 0)\n  }\n  public static from(o: TransformLike) {\n    return new Transform(o.a, o.b, o.c, o.d, o.e, o.f)\n  }\n  public static fromAngle(theta: number) {\n    return new Transform(\n      Math.cos(theta),\n      Math.sin(theta),\n      -Math.cos(theta),\n      Math.sin(theta),\n      0,\n      0\n    )\n  }\n  public set(o: TransformLike) {\n    this.a = o.a\n    this.b = o.b\n    this.c = o.c\n    this.d = o.d\n    this.e = o.e\n    this.f = o.f\n  }\n  public setFromArray(arr: number[]) {\n    this.a = arr[0]\n    this.b = arr[1]\n    this.c = arr[2]\n    this.d = arr[3]\n    this.e = arr[4]\n    this.f = arr[5]\n  }\n  public copy(t: Transform) {\n    this.a = t.a\n    this.b = t.b\n    this.c = t.c\n    this.d = t.d\n    this.e = t.e\n    this.f = t.f\n    return this\n  }\n  public clone() {\n    return Transform.from(this)\n  }\n  public reset() {\n    this.a = 1\n    this.b = 0\n    this.c = 0\n    this.d = 1\n    this.e = 0\n    this.f = 0\n    return this\n  }\n  public equal(t: Transform) {\n    return (\n      this.a === t.a &&\n      this.b === t.b &&\n      this.c === t.c &&\n      this.d === t.d &&\n      this.e === t.e &&\n      this.f === t.f\n    )\n  }\n\n  public translate(v: Vector2) {\n    return this.translate2(v.x, v.y)\n  }\n  public translate2(x: number, y: number) {\n    this.e += x\n    this.f += y\n    return this\n    // return this.rightMultiply(new Transform(1, 0, 0, 1, x, y))\n  }\n  // @todo: 写该类的测试\n  public rotateAtOrigin(radius: number) {\n    let [sina, cosa] = [Math.sin(radius), Math.cos(radius)]\n    return this.rightMultiply(new Transform(cosa, sina, -sina, cosa, 0, 0))\n  }\n  public rotate(radius: number, p: Vector2) {\n    // T1 * R * T2 * CTM（平移旋转再平移）\n    return this.translate(Vector2.zeros().subtract(p))\n      .rotateAtOrigin(radius)\n      .translate(p)\n  }\n\n  public scale(x: number, y: number, p: Vector2) {\n    return this.copy(\n      Transform.identity()\n        .translate(p.opposite())\n        .scaleAtOrigin(x, y)\n        .translate(p)\n        .rightMultiply(this)\n    )\n  }\n  public scale2(x: number, y: number, p: Vector2) {\n    return this.translate(p.opposite()).scale2AtOrigin(x, y).translate(p)\n  }\n  public scale2AtOrigin(x: number, y: number) {\n    return this.rightMultiply(new Transform(x, 0, 0, y, 0, 0))\n  }\n\n  public scaleAtOrigin(x, y) {\n    this.a *= x\n    this.e *= x\n    this.d *= y\n    this.f *= y\n    return this\n  }\n\n  public flipY() {\n    const { a, b, c, d, e, f } = this\n    let [x, y] = [1 / 2, 1 / 2]\n    let [x1, y1] = [a * x + c * y + e, b * x + d * y + f]\n    this.rightMultiply(new Transform(-1, 0, 0, 1, 0, 0)).translate2(2 * x1, 0)\n    return this\n  }\n\n  // 原矩阵在右边👉\n  public rightMultiply(tm: Transform) {\n    let a = tm.a * this.a + tm.c * this.b\n    let b = tm.b * this.a + tm.d * this.b\n    let c = tm.a * this.c + tm.c * this.d\n    let d = tm.b * this.c + tm.d * this.d\n    let e = tm.a * this.e + tm.c * this.f + tm.e\n    let f = tm.b * this.e + tm.d * this.f + tm.f\n    this.a = a\n    this.b = b\n    this.c = c\n    this.d = d\n    this.e = e\n    this.f = f\n    return this\n  }\n  public leftMultiply(tm: Transform) {}\n\n  // 矩阵的逆\n  public inverse() {\n    let { a, b, c, d, e, f } = this\n    let detA = a * d - b * c\n    return new Transform(\n      d / detA,\n      -b / detA,\n      -c / detA,\n      a / detA,\n      (c * f - d * e) / detA,\n      (b * e - a * f) / detA\n    )\n  }\n\n  // @todo: 放在此处不太规范，耦合性太强\n  public cssString() {\n    return `matrix(${this.a},${this.b},${this.c},${this.d},${this.e},${this.f})`\n  }\n}\n\ninterface TransformLike {\n  a: number\n  b: number\n  c: number\n  d: number\n  e: number\n  f: number\n}\n\nexport class Matrix {}\n","import { Box } from \"./Box\"\nimport { Transform } from \"./Transform\"\nimport { Vector2 } from \"./Vector\"\n\nexport class Area {\n  private _box: Box\n  public get box(): Box {\n    return this._box\n  }\n  public set box(value: Box) {\n    this._box = value\n  }\n  private _transform: Transform\n  public get transform(): Transform {\n    return this._transform\n  }\n  public set transform(value: Transform) {\n    this._transform = value\n  }\n  constructor(box: Box, tranform: Transform) {\n    this.box = box\n    this.transform = tranform\n  }\n\n  public clone() {\n    return new Area(this.box.clone(), this.transform.clone())\n  }\n\n  public include(p: Vector2) {\n    // @todo: finish this with transform\n    let pp = p.clone().applyTransform(this._transform.inverse())\n    // debugger\n    return (\n      pp.x < this.box.x2 &&\n      pp.x > this.box.x &&\n      pp.y < this.box.y2 &&\n      pp.y > this.box.y\n    )\n  }\n\n  public nearestCornerDistance(p: Vector2) {\n    // 逆时针顺序\n    let corners = [\n      new Vector2(this.box.x, this.box.y),\n      new Vector2(this.box.x, this.box.y2),\n      new Vector2(this.box.x2, this.box.y2),\n      new Vector2(this.box.x2, this.box.y),\n    ]\n    let distances = corners\n      .map((c) => c.applyTransform(this._transform))\n      .map((c) => c.distance(p))\n    return distances\n  }\n\n  public center() {\n    return this.box.center().clone().applyTransform(this.transform)\n  }\n}\n","export const NS = {\n  HTML: \"http://www.w3.org/1999/xhtml\",\n  MATH: \"http://www.w3.org/1998/Math/MathML\",\n  SE: \"http://svg-edit.googlecode.com\",\n  SVG: \"http://www.w3.org/2000/svg\",\n  XLINK: \"http://www.w3.org/1999/xlink\",\n  OI: \"http://www.optimistik.fr/namespace/svg/OIdata\",\n  XML: \"http://www.w3.org/XML/1998/namespace\",\n  XMLNS: \"http://www.w3.org/2000/xmlns/\", // see http://www.w3.org/TR/REC-xml-names/#xmlReserved\n};\n","import { NS } from \"./namespaces\"\n\nexport const generateSvgElement = (docuemnt: Document, attributes?: any) => {\n  let ele = docuemnt.createElementNS(NS.SVG, \"svg\") as SVGElement\n  if (!attributes) return\n  Object.keys(attributes).forEach((key) => {\n    ele.setAttribute(key, attributes[key])\n  })\n  return ele\n}\n\nexport const setAttr = (element: Element, attr: any) => {\n  Object.keys(attr).forEach((key) => {\n    element.setAttribute(key, attr[key])\n  })\n}\n\nlet id = 100000\n\nexport const generateId = () => {\n  return \"node-\" + id++\n}\n\nexport const isMac = () => {\n  let agent = navigator.userAgent.toLowerCase()\n  let isMac = /macintosh|mac os x/i.test(agent)\n  return isMac\n}\n","import { Box } from \"./Box\"\nimport { Board } from \"./Board\"\nimport { Log } from \"./Log\"\nimport { Transform } from \"./Transform\"\nimport { Vector2 } from \"./Vector\"\nimport { Area } from \"./Area\"\nimport { generateId } from \"./utilities\"\nimport { EventType } from \"./EventEmitter\"\n\nexport abstract class BaseElement {\n  protected _id: string\n  public get id(): string {\n    return this._id\n  }\n  public set id(value: string) {\n    this._id = value\n  }\n  protected board: Board\n  protected _area: Area\n  public get area(): Area {\n    return this._area\n  }\n  public set area(value: Area) {\n    this._area = value\n  }\n  protected _domInstance: SVGElement\n  public get domInstance(): SVGElement {\n    if (!this._domInstance) this.createDomInstance()\n    return this._domInstance\n  }\n  public set domInstance(value: SVGElement) {\n    this._domInstance = value\n  }\n  public get frameWidth(): number {\n    return this.transform.a\n  }\n  public get frameHeight(): number {\n    return this.transform.d\n  }\n  protected absoluteBBox: Box\n  protected _transform: Transform\n  public get transform(): Transform {\n    return this._transform\n  }\n  public set transform(value: Transform) {\n    this._transform = value\n  }\n  private _lastTransform: Transform\n  public get lastTransform(): Transform {\n    return this._lastTransform\n  }\n  public set lastTransform(value: Transform) {\n    this._lastTransform = value\n  }\n  // 元素的 AABB 框，在对元素进行变换时需要更新\n  private _AABB: Box\n  public get AABB(): Box {\n    return this._AABB\n  }\n  public set AABB(value: Box) {\n    this._AABB = value\n  }\n  // 额外的位置信息（受旋转影响），用于将来绑定编辑面板上元素位置信息，一定要区分它和 transform 的区别\n  // 注意旋转，位移，缩放后都要及时更新该信息\n  protected position: Vector2\n  protected _zIndex: number\n  public get zIndex(): number {\n    return this._zIndex\n  }\n  public set zIndex(value: number) {\n    this._zIndex = value\n  }\n\n  private _points: Vector2[]\n  public get points(): Vector2[] {\n    return this._points\n  }\n  public set points(value: Vector2[]) {\n    this._points = value\n  }\n\n  constructor(x: number, y: number, w: number, h: number) {\n    this.id = generateId()\n    this.transform = Transform.identity()\n    this.transform.a = w\n    this.transform.d = h\n    this.transform.translate2(x, y)\n    this.board = (window as any).board\n    this.AABB = new Box(x, y, w, h)\n    this.area = new Area(new Box(0, 0, 1, 1), this.transform)\n    // @todo: get the right index\n    this.zIndex = 0\n\n    this.board.eventEmitter.on(\n      EventType.CreateStart,\n      this.onCreateStart.bind(this)\n    )\n    this.board.eventEmitter.on(EventType.Creating, this.onCreating.bind(this))\n    this.board.eventEmitter.on(EventType.CreateEnd, this.onCreateEnd.bind(this))\n  }\n\n  public onCreateStart() {}\n  public onCreating() {\n    if (this.board.selection[0] == this) {\n    }\n  }\n  public onCreateEnd() {}\n\n  // public setFrameWidth(w: number) {\n  //   this.frameWidth = w\n  // }\n  // public setFrameHeight(h: number) {\n  //   this.frameHeight = h\n  // }\n  protected abstract createDomInstance(): void\n  public abstract updateRendering(): void\n\n  // everytime element is transformed, this should be call\n  public updatePoints() {\n    let corners = this.area.box.toVector2()\n    this.points = corners.map((p) => p.applyTransform(this.transform))\n  }\n\n  protected updateAABB() {\n    let minX = Math.min(...this.points.map((p) => p.x))\n    let minY = Math.min(...this.points.map((p) => p.y))\n    let maxX = Math.max(...this.points.map((p) => p.x))\n    let maxY = Math.max(...this.points.map((p) => p.y))\n    // this.AABB.setSize(this.frameWidth, this.frameHeight)\n    this.AABB.set4(minX, minY, maxX - minX, maxY - minY)\n  }\n}\n","export const Default = {\n  fill: \"#d9d9d9\",\n};\n","import { BaseElement } from \"./BaseElement\"\nimport { Default } from \"./Constant\"\nimport { NS } from \"./namespaces\"\nimport { Transform } from \"./Transform\"\nimport { setAttr } from \"./utilities\"\n\ninterface EllipseAttr {\n  cx: number\n  cy: number\n  rx: number\n  ry: number\n}\n\nexport class ELLIPSE extends BaseElement {\n  private attr: EllipseAttr\n\n  constructor(x: number, y: number, width: number, height: number) {\n    super(x, y, width, height)\n\n    this.attr = {\n      cx: 0,\n      cy: 0,\n      rx: 1 / 2,\n      ry: 1 / 2,\n    }\n  }\n\n  protected createDomInstance() {\n    const element = document.createElementNS(\n      NS.SVG,\n      \"ellipse\"\n    ) as SVGEllipseElement\n    setAttr(element, this.attr)\n    setAttr(element, { fill: Default.fill })\n    this._domInstance = element\n  }\n\n  public updateAttr() {\n    this.attr = {\n      cx: 0,\n      cy: 0,\n      rx: 1 / 2,\n      ry: 1 / 2,\n    }\n  }\n\n  public updateRendering(): void {\n    this.updateAttr()\n    this.updatePoints()\n    this.updateAABB()\n    setAttr(this._domInstance, this.attr)\n    // svg 渲染椭圆在缩放时中心位置也会跟着缩放，cx, cy设置为 0 可避免该问题，但渲染位置就要做适当的偏移\n    let transform = new Transform(1, 0, 0, 1, 1 / 2, 1 / 2).rightMultiply(\n      this._transform\n    )\n    const { a, b, c, d, e, f } = transform\n    setAttr(this._domInstance, {\n      transform: `matrix(${a},${b},${c},${d},${e},${f})`,\n    })\n  }\n\n  public onCreateStart(): void {}\n  public onCreating(): void {}\n  public onCreateEnd(): void {}\n}\n","import { BaseElement } from \"./BaseElement\"\nimport { Default } from \"./Constant\"\nimport { NS } from \"./namespaces\"\nimport { setAttr } from \"./utilities\"\n\ninterface RectAttr {\n  x: number\n  y: number\n  width: number\n  height: number\n}\nexport class Rect extends BaseElement {\n  private attr: RectAttr\n\n  // public get domInstance(): SVGRectElement {\n  //   if (!this._domInstance) this._domInstance = this.createDomInstance();\n  //   return this._domInstance;\n  // }\n  // public set domInstance(value: SVGRectElement) {\n  //   this._domInstance = value;\n  // }\n\n  constructor(x: number, y: number, width: number, height: number) {\n    super(x, y, width, height)\n    this.attr = {\n      x: 0,\n      y: 0,\n      width: 1,\n      height: 1,\n    }\n  }\n\n  protected createDomInstance() {\n    const element = document.createElementNS(NS.SVG, \"rect\") as SVGRectElement\n    setAttr(element, this.attr)\n    setAttr(element, { fill: Default.fill })\n    this._domInstance = element\n  }\n\n  public updateAttr() {\n    this.attr.width = this.frameWidth\n    this.attr.height = this.frameHeight\n  }\n\n  public updateRendering(): void {\n    this.updatePoints()\n    this.updateAABB()\n    const { a, b, c, d, e, f } = this._transform\n    setAttr(this._domInstance, {\n      transform: `matrix(${a},${b},${c},${d},${e},${f})`,\n    })\n  }\n\n  // public onCreateStart(): void {}\n  public onCreating() {\n    this.updateAABB()\n  }\n  // public onCreateEnd(): void {}\n}\n","const config = {\n  COLOR_SELECT: \"#009aff\",\n}\n\nexport default config\n","import { Board } from \"./Board\"\nimport { BoardEvent, EventEmitter, EventType } from \"./EventEmitter\"\n\ninterface IManager {}\n\nexport class Manager implements IManager {\n  board: Board\n  protected eventEmitter: EventEmitter\n\n  constructor(board: Board) {\n    this.board = board\n    this.eventEmitter = this.board.eventEmitter\n\n    this.board.eventEmitter.on(EventType.MouseDown, this.onMouseDown.bind(this))\n    this.board.eventEmitter.on(EventType.MouseMove, this.onMouseMove.bind(this))\n    this.board.eventEmitter.on(EventType.MouseUp, this.onMouseUp.bind(this))\n  }\n\n  public onMouseDown(e: BoardEvent) {}\n  public onMouseMove(e: BoardEvent) {}\n  public onMouseUp(e: BoardEvent) {}\n}\n","import { Area } from \"./Area\"\nimport { Board } from \"./Board\"\nimport { Box } from \"./Box\"\nimport config from \"./config\"\nimport { BoardEvent, EventType } from \"./EventEmitter\"\nimport { Log } from \"./Log\"\nimport { Manager } from \"./Manager\"\nimport { NS } from \"./namespaces\"\nimport { Transform } from \"./Transform\"\nimport { setAttr } from \"./utilities\"\nimport { Vector2 } from \"./Vector\"\n\n// @todo: refractor as a plugin\nexport class Selector extends Manager {\n  private container: SVGElement\n  private selectorRoot: SVGGElement\n  private selectRect: SVGRectElement\n  private activeGroup: SVGGElement\n  private activeMap: Map<string, SVGPathElement>\n  private manuplator: SVGGElement\n  private manuplatorRect: SVGPathElement\n  private manuplatorPoints: SVGGElement\n  private selectedCorner: SVGGElement\n  private selectArea: Area\n  private lastSelectedNum: number\n\n  private selectorTransform: Transform\n  constructor(board: Board) {\n    super(board)\n    this.board = board\n    this.container = board.svgroot\n    this.selectorRoot = board.svgdoc.createElementNS(NS.SVG, \"g\") as SVGGElement\n    this.selectRect = board.svgdoc.createElementNS(\n      NS.SVG,\n      \"rect\"\n    ) as SVGRectElement\n    this.activeGroup = board.svgdoc.createElementNS(NS.SVG, \"g\") as SVGGElement\n    this.selectorRoot.append(this.activeGroup)\n    this.activeMap = new Map()\n\n    this.manuplator = board.svgdoc.createElementNS(NS.SVG, \"g\") as SVGGElement\n    this.selectorRoot.append(this.manuplator)\n    setAttr(this.manuplator, { display: \"none\" })\n\n    this.manuplatorRect = board.svgdoc.createElementNS(\n      NS.SVG,\n      \"path\"\n    ) as SVGPathElement\n    setAttr(this.manuplatorRect, {\n      fill: \"none\",\n      \"stroke-width\": 2.5,\n      stroke: config.COLOR_SELECT,\n    })\n    this.manuplator.append(this.manuplatorRect)\n    this.manuplatorPoints = board.svgdoc.createElementNS(\n      NS.SVG,\n      \"g\"\n    ) as SVGGElement\n    this.manuplator.append(this.manuplatorPoints)\n    for (let i = 0; i < 4; i++) {\n      let point = board.svgdoc.createElementNS(NS.SVG, \"path\")\n      setAttr(point, {\n        fill: \"#fcfcfc\",\n        \"stroke-width\": 1.5,\n        stroke: config.COLOR_SELECT,\n      })\n      this.manuplatorPoints.append(point)\n    }\n\n    this.lastSelectedNum = 0\n    this.selectArea = new Area(new Box(0, 0, 1, 1), Transform.identity())\n    // @todo: 一些初始设置blabla\n    setAttr(this.selectRect, {\n      fill: \"#f00\",\n      stroke: \"#66c\",\n      \"stroke-width\": \"0.5\",\n      \"fill-opacity\": \"0.15\",\n      display: \"none\",\n    })\n    this.selectorRoot.append(this.selectRect)\n    this.container.append(this.selectorRoot)\n\n    board.eventEmitter.on(EventType.SelectStart, this.onSelectStart.bind(this))\n    board.eventEmitter.on(EventType.Selecting, this.onSelectMove.bind(this))\n    board.eventEmitter.on(EventType.SelectEnd, this.onSelectEnd.bind(this))\n    board.eventEmitter.on(\n      EventType.ElementSelected,\n      this.onElemetSelected.bind(this)\n    )\n    board.eventEmitter.on(\n      EventType.NothingSelected,\n      this.onNothingSelected.bind(this)\n    )\n    board.eventEmitter.on(EventType.Creating, this.onCreating.bind(this))\n    board.eventEmitter.on(EventType.Draging, this.onDraging.bind(this))\n    board.eventEmitter.on(EventType.Rotating, this.onRotating.bind(this))\n    board.eventEmitter.on(EventType.Scaling, this.onScaling.bind(this))\n    board.eventEmitter.on(\n      EventType.ElementChanged,\n      this.onElementChanged.bind(this)\n    )\n  }\n\n  private onSelectStart(e) {\n    setAttr(this.selectRect, { display: \"inline\" })\n  }\n\n  private onSelectMove(e) {\n    let x = Math.min(e.customData.startX, e.customData.endX)\n    let y = Math.min(e.customData.startY, e.customData.endY)\n    let width = Math.abs(e.customData.endX - e.customData.startX)\n    let height = Math.abs(e.customData.endY - e.customData.startY)\n\n    setAttr(this.selectRect, { x, y, width, height })\n    this.selectArea.box.x = x\n    this.selectArea.box.y = y\n    this.selectArea.box.w = width\n    this.selectArea.box.h = height\n    let selected = []\n    // @todo: 判断方式需要改一下，矩形相交\n    this.board.elements.forEach((e) => {\n      if (e.points.find((p) => this.selectArea.include(p))) {\n        selected.push(e)\n      }\n    })\n    if (this.lastSelectedNum != selected.length) {\n      this.board.setSelected(selected)\n      this.lastSelectedNum = selected.length\n    }\n  }\n  private onSelectEnd(e: BoardEvent) {\n    this.selectRect.setAttribute(\"display\", \"none\")\n    this.selectRect.setAttribute(\"width\", \"0\")\n    this.selectRect.setAttribute(\"height\", \"0\")\n  }\n\n  private onElemetSelected(e: BoardEvent) {\n    this.updateRender()\n  }\n\n  private onNothingSelected(e: BoardEvent) {\n    this.activeMap.forEach((ele) => setAttr(ele, { display: \"none\" }))\n    setAttr(this.manuplator, { display: \"none\" })\n  }\n\n  private onDragStart(e: BoardEvent) {}\n\n  private onCreateStart(e: BoardEvent) {}\n\n  private onCreating(e: BoardEvent) {\n    this.onElemetSelected(e)\n  }\n\n  private onDraging(e: BoardEvent) {\n    this.onElemetSelected(e)\n  }\n\n  private onRotating(e: BoardEvent) {\n    this.updateRender()\n  }\n\n  private onScaling(e: BoardEvent) {\n    this.updateRender()\n  }\n\n  private onElementCreateing(e: BoardEvent) {\n    const elements = this.board.selection\n    // 获取最大宽高，若一个元素，则取该元素的 BBOX，多个元素则取 AABB 的并集\n    if (!elements) return\n    if (elements.length === 1) {\n      const { transform, frameWidth, frameHeight } = elements[0]\n      let rect = { x: 0, y: 0, width: frameWidth, height: frameHeight }\n      setAttr(this.activeMap.get(elements[0].id), {\n        transform: transform.cssString(),\n        display: \"inline\",\n        ...rect,\n      })\n    }\n  }\n\n  private onElementChanged(e: BoardEvent) {\n    this.updateRender()\n  }\n\n  private updateSelector() {}\n\n  private updateRender() {\n    this.clear()\n    const elements = this.board.selection\n    // 获取最大宽高，若一个元素，则取该元素的 BBOX，多个元素则取 AABB 的并集\n    if (!elements) return\n    for (let element of elements) {\n      const { transform } = element\n      if (!this.activeMap.has(element.id)) {\n        let ele = this.board.svgdoc.createElementNS(\n          NS.SVG,\n          \"path\"\n        ) as SVGPathElement\n        this.activeMap.set(element.id, ele)\n        this.activeGroup.append(ele)\n        setAttr(ele, {\n          id: element.id,\n          fill: \"none\",\n          stroke: config.COLOR_SELECT,\n          \"stroke-width\": \"2.5\",\n          \"fill-opacity\": \"0.15\",\n          display: \"none\",\n        })\n      }\n      // 计算 path 各个点，并导出成字符串\n      let ps = [\n        Vector2.zeros(),\n        new Vector2(0, 1),\n        Vector2.ones(),\n        new Vector2(1, 0),\n      ]\n      ps.forEach((p) => p.applyTransform(transform))\n      let pathStr = \"M\" + ps.map((p) => p.x + \",\" + p.y).join(\"L\") + \"Z\"\n      setAttr(this.activeMap.get(element.id), {\n        display: \"inline\",\n        d: pathStr,\n      })\n    }\n    if (elements.length === 1) {\n      setAttr(this.manuplator, {\n        display: \"inline\",\n      })\n      let { box } = elements[0].area\n      let ps = box.toVector2()\n      ps.forEach((p) => p.applyTransform(elements[0].transform))\n\n      // 选中单个元素的框是和元素的框一致的\n      setAttr(this.manuplatorRect, {\n        display: \"none\",\n      })\n      const width = 6\n      let points = Array.from(this.manuplatorPoints.children)\n      // 操作框仅需要与旋转值保持同步\n      // FIX: 此处的旋转值还有一点问题\n      points.forEach((p, i) => {\n        setAttr(p, {\n          d: generatePathStr(\n            ps[i].x,\n            ps[i].y,\n            width,\n            elements[0].transform.rotation\n          ),\n        })\n      })\n    } else if (elements.length >= 2) {\n      // show the selector outside\n      setAttr(this.manuplator, {\n        display: \"inline\",\n      })\n      setAttr(this.manuplatorRect, {\n        display: \"inline\",\n      })\n      let { box } = this.board.selectionArea\n      let ps = box.toVector2()\n      let pathStr = `M${box.x},${box.y}L${box.x},${box.y2}L${box.x2},${box.y2}L${box.x2},${box.y}Z`\n      setAttr(this.manuplator.children[0], {\n        d: pathStr,\n      })\n      const width = 6\n      let points = Array.from(this.manuplatorPoints.children)\n      points.forEach((p, i) => {\n        setAttr(p, { d: generatePathStr(ps[i].x, ps[i].y, width) })\n      })\n    }\n  }\n\n  private clear() {\n    this.activeMap.forEach((e) => setAttr(e, { display: \"none\" }))\n  }\n}\n\nexport function generatePathStr(\n  x: number,\n  y: number,\n  width: number,\n  rotation?: number\n) {\n  let points = [\n    new Vector2(x - width / 2, y - width / 2),\n    new Vector2(x - width / 2, y + width / 2),\n    new Vector2(x + width / 2, y + width / 2),\n    new Vector2(x + width / 2, y - width / 2),\n  ]\n  if (rotation) {\n    points.forEach((p) =>\n      p.applyTransform(Transform.identity().rotate(rotation, new Vector2(x, y)))\n    )\n  }\n  let pathStr = \"M\" + points.map((p) => p.x + \",\" + p.y).join(\"L\") + \"Z\"\n  return pathStr\n}\n","export class Log {\n  public static Error(message: string) {\n    console.error(message)\n  }\n\n  public static Warn(message: string) {\n    console.warn(message)\n  }\n  public static Info(message: string) {\n    console.info(message)\n  }\n\n  public static blue(message: string) {\n    console.info(\"%c \" + message, \"color:blue;\")\n  }\n  public static red(message: string) {\n    console.info(\"%c \" + message, \"color:red;\")\n  }\n}\n","import { BaseElement } from \"./BaseElement\"\nimport { ELLIPSE } from \"./Ellipse\"\nimport { BoardEvent, EventEmitter, EventType } from \"./EventEmitter\"\nimport { NS } from \"./namespaces\"\nimport { Rect } from \"./Rect\"\nimport { generateSvgElement, isMac, setAttr } from \"./utilities\"\nimport { Selector } from \"./Selector\"\nimport { Log } from \"./Log\"\nimport { Area } from \"./Area\"\nimport { Box } from \"./Box\"\nimport { Transform } from \"./Transform\"\nimport { Vector2 } from \"./Vector\"\nimport { MouseStatusManager } from \"./MouseStatusManager\"\nimport { ShortcutManager } from \"./ShortcutManager\"\nimport { UndoManager } from \"./history\"\n\nexport class Board {\n  private saveOptions: any\n  private _selection: BaseElement[]\n  fx: number\n  fy: number\n  lastSelectionArea: Area\n  _cachedKeyEvent: BoardEvent\n  undoManager: UndoManager\n  public get selection(): BaseElement[] {\n    return this._selection\n  }\n  public set selection(value: BaseElement[]) {\n    this._selection = value\n  }\n  private _selectionArea: Area\n  public get selectionArea(): Area {\n    return this._selectionArea\n  }\n  public set selectionArea(value: Area) {\n    this._selectionArea = value\n  }\n  private plugins: any[]\n  private currentMode: EditorMode\n  private currentResizeMode: ResizeMode\n  private rubberBox: HTMLElement\n  private curBBoxes: any[]\n  private selector: Selector\n  private _container: HTMLElement\n  public get container(): HTMLElement {\n    return this._container\n  }\n  public set container(value: HTMLElement) {\n    this._container = value\n  }\n  private _elements: BaseElement[]\n  public get elements(): BaseElement[] {\n    return this._elements\n  }\n  public set elements(value: BaseElement[]) {\n    this._elements = value\n  }\n  private _svgdoc: Document\n  private _eventEmitter: EventEmitter\n  private _cachedEvent: BoardEvent\n\n  private mouseStatusManager: MouseStatusManager\n  private shotcutManager: ShortcutManager\n\n  private boardX = 0\n  private boardY = 0\n\n  // mouse relative\n  // @todo: maybe not need this\n  private MouseDown = false\n  private mouseStartX = 0\n  private mouseStartY = 0\n  private lastZIndex = 0\n  private _currentCreateMode: CreateMode\n  public get currentCreateMode(): CreateMode {\n    return this._currentCreateMode\n  }\n  public set currentCreateMode(value: CreateMode) {\n    this._currentCreateMode = value\n  }\n\n  public get eventEmitter(): EventEmitter {\n    return this._eventEmitter\n  }\n  public set eventEmitter(value: EventEmitter) {\n    this._eventEmitter = value\n  }\n  public get svgdoc(): Document {\n    return this._svgdoc\n  }\n  public set svgdoc(value: Document) {\n    this._svgdoc = value\n  }\n  private _svgroot: SVGElement\n  public get svgroot(): SVGElement {\n    return this._svgroot\n  }\n  public set svgroot(value: SVGElement) {\n    this._svgroot = value\n  }\n  private svgcontent: SVGElement\n  public static idPrefix = \"svg\"\n  private curConfig: any\n  private canvasBg: SVGElement\n\n  // @todo: 此处存放一些交互时需要暂存的信息，后续看下怎么优化\n  private selectionTransforms: Transform[]\n  private lastFrameWidth: number\n  private lastFrameHeight: number\n\n  constructor(container: HTMLElement) {\n    this.container = container\n    this.saveOptions = {}\n    this.selection = []\n    this.selectionArea = new Area(new Box(0, 0, 1, 1), Transform.identity())\n    this.plugins = []\n    this.currentMode = EditorMode.SELECT\n    this.currentResizeMode = ResizeMode.CASUAL\n    this.rubberBox = null\n    this.curBBoxes = []\n    this.curConfig = {\n      dimensions: this.getTargetDimensions(),\n    }\n    this.elements = []\n    this.selectionTransforms = []\n\n    this.svgdoc = document\n\n    this._eventEmitter = new EventEmitter()\n\n    // !!! 画板自身的事件要先注册，以便管理器和插件拿到的是最新的状态\n    this.initEventHandler()\n    this.initCustomEventHandler()\n\n    this._cachedEvent = new BoardEvent(\"\", null)\n    this._cachedKeyEvent = new BoardEvent(\"\", null)\n    this.mouseStatusManager = new MouseStatusManager(this)\n    this.undoManager = new UndoManager(this)\n    this.shotcutManager = new ShortcutManager(this)\n\n    this.updateBoardPosition()\n\n    this.svgroot = this.svgdoc.createElementNS(NS.SVG, \"svg\") as SVGElement\n\n    const svgAttributs = {\n      xmlns: \"http://www.w3.org/2000/svg\",\n      id: \"svgroot\",\n      xlinks: \"http://www.w3.org/1999/xlink\",\n      width: this.curConfig.dimensions[0],\n      height: this.curConfig.dimensions[1],\n      overflow: \"visible\",\n    }\n    Object.keys(svgAttributs).forEach((key) => {\n      this.svgroot.setAttribute(key, svgAttributs[key])\n    })\n\n    const bgAttributes = {\n      id: \"svgBg\",\n      width: this.curConfig.dimensions[0],\n      height: this.curConfig.dimensions[1],\n      stroke: \"#000\",\n      fill: \"#fbfbfb\",\n      style: \"pointer-events: none\",\n    }\n    this.canvasBg = generateSvgElement(this._svgdoc, bgAttributes)\n\n    const rect = this.svgdoc.createElementNS(NS.SVG, \"rect\") as SVGRectElement\n    const rectAttributes = {\n      id: \"blabla\",\n      width: \"100%\",\n      height: \"100%\",\n      stroke: \"#000\",\n      fill: \"#f8f8f8\",\n      style: \"pointer-events: none\",\n      x: 0,\n      y: 0,\n    }\n    Object.keys(rectAttributes).forEach((key) => {\n      rect.setAttribute(key, rectAttributes[key])\n    })\n    this.canvasBg.append(rect)\n\n    this.svgcontent = generateSvgElement(this.svgdoc, {\n      ...svgAttributs,\n      id: \"svgcontent\",\n    })\n\n    this.svgroot.append(this.canvasBg)\n    this.svgroot.append(this.svgcontent)\n    this.container.append(this.svgroot)\n\n    this.addInstructions()\n\n    this.initSelector()\n\n    // @todo: 传递画板的引用给元素，有没有更好的办法？？\n    ;(window as any).board = this\n  }\n\n  private getTargetDimensions() {\n    let width = window.innerWidth\n    let height = window.innerHeight\n    return [width, height]\n  }\n\n  private updateBoardSize() {\n    let svg2BeUpdate = [this.svgroot, this.canvasBg, this.svgcontent]\n    svg2BeUpdate.forEach((item) => {\n      setAttr(item, {\n        width: this.curConfig.dimensions[0],\n        height: this.curConfig.dimensions[1],\n      })\n    })\n  }\n\n  private addInstructions() {\n    let instruction = this._svgdoc.createElementNS(\n      NS.SVG,\n      \"foreignObject\"\n    ) as SVGForeignObjectElement\n    setAttr(instruction, {\n      x: \"0\",\n      y: \"40%\",\n      width: \"100%\",\n      height: \"200\",\n    })\n    let p = this._svgdoc.createElement(\"p\") as HTMLParagraphElement\n    let texts = [\n      \"press R to draw Rectangle\",\n      \"press O to draw Ellipse\",\n      `press ${isMac() ? \"Command\" : \"Ctrl\"} + Z to undo`,\n      `press ${isMac() ? \"Command\" : \"Ctrl\"} + Shift + Z to redo`,\n    ]\n    p.innerHTML = texts.join(\"<br />\")\n    p.setAttribute(\n      \"style\",\n      \"text-align: center; color: #bbb; user-select: none\"\n    )\n    instruction.append(p)\n    this.svgroot.append(instruction)\n  }\n\n  private initSelector() {\n    this.selector = new Selector(this)\n  }\n\n  private initEventHandler() {\n    // @todo: maybe 需要监听画板是否加载完成，后续优化\n    this.container.addEventListener(\n      \"mousedown\",\n      this.handleMouseDown.bind(this)\n    )\n    this.container.addEventListener(\"mouseup\", this.handleMouseUp.bind(this))\n    this.container.addEventListener(\"click\", this.handleClick.bind(this))\n    this.container.addEventListener(\"dblclick\", this.handleDBClick.bind(this))\n    this.container.addEventListener(\n      \"mousemove\",\n      this.handleMouseMove.bind(this)\n    )\n    window.addEventListener(\"resize\", this.handleResize.bind(this))\n    this.container.addEventListener(\"keydown\", this.handleKeyDown.bind(this))\n  }\n\n  private initCustomEventHandler() {\n    this._eventEmitter.on(EventType.SelectStart, this.onSelectStart.bind(this))\n    this._eventEmitter.on(\n      EventType.CreateStart,\n      this.onCreateElement.bind(this)\n    )\n    this._eventEmitter.on(EventType.Creating, this.onCreateMove.bind(this))\n    this._eventEmitter.on(EventType.CreateEnd, this.onCreateEnd.bind(this))\n    this._eventEmitter.on(EventType.ChangeMode, this.onChangeMode.bind(this))\n    this._eventEmitter.on(EventType.DragStart, this.onDragStart.bind(this))\n    this._eventEmitter.on(EventType.Draging, this.onDraging.bind(this))\n    this._eventEmitter.on(EventType.DragEnd, this.onDragEnd.bind(this))\n    this._eventEmitter.on(EventType.RotateStart, this.onRotateStart.bind(this))\n    this._eventEmitter.on(EventType.Rotating, this.onRotating.bind(this))\n    this._eventEmitter.on(EventType.RotateEnd, this.onRotateEnd.bind(this))\n    this._eventEmitter.on(EventType.ScaleStart, this.onScaleStart.bind(this))\n    this._eventEmitter.on(EventType.Scaling, this.onScaling.bind(this))\n    this._eventEmitter.on(EventType.ScaleEnd, this.onScaleEnd.bind(this))\n    this._eventEmitter.on(\n      EventType.MouseStatusChange,\n      this.onMouseStatusChange.bind(this)\n    )\n    this._eventEmitter.on(\n      EventType.ElementChanged,\n      this.onElementChanged.bind(this)\n    )\n    // 封装一层，获取鼠标相对 x,y\n    this._eventEmitter.on(EventType.MouseDown, this.onMouseDown.bind(this))\n    this._eventEmitter.on(EventType.MouseMove, this.onMouseMove.bind(this))\n    this._eventEmitter.on(EventType.MouseUp, this.onMouseUp.bind(this))\n  }\n\n  private updateBoardPosition() {\n    let bbox = this.container.getBoundingClientRect()\n    this.boardX = bbox.x\n    this.boardY = bbox.y\n  }\n\n  public exportSvg(): string {\n    return \"\"\n  }\n\n  // @todo: 这个方法修饰符应该设置成 private or protected\n  public setSelected(elements: BaseElement[]) {\n    console.log(\"selection: \", elements)\n    this.selection = elements\n    let eventType = EventType.ElementSelected\n    if (!elements || elements.length == 0) {\n      eventType = EventType.NothingSelected\n    } else {\n      // elements.forEach((e) => console.log(e.id, e.transform.a))\n      this.updateSelectionArea()\n      this._cachedEvent.customData = {\n        elements,\n        area: this.selectionArea,\n      }\n    }\n    // @todo: create new events derived from BoardEvent\n    this._eventEmitter.trigger(eventType, [this._cachedEvent])\n  }\n\n  public setMode(mode: EditorMode) {\n    this.currentMode = mode\n    this._cachedEvent.customData = {\n      mode,\n    }\n    this._eventEmitter.trigger(EventType.ChangeMode, [this._cachedEvent])\n  }\n\n  private updateSelectionArea() {\n    let elements = this.selection\n    // calculate area\n    if (elements.length == 1) {\n      this.selectionArea.transform = elements[0].transform.clone()\n      this.selectionArea.box = new Box(0, 0, 1, 1)\n    } else {\n      this.selectionArea.transform.reset()\n      this.selectionArea.box = Box.mergeAll(elements.map((e) => e.AABB))\n      // console.log(elements[0].transform)\n      // console.log(elements[1].transform)\n      // console.log(elements.map((e) => e.AABB))\n      // console.log(this.selectionArea.box)\n    }\n  }\n\n  // delegate method on & trigger to board\n  public on(event: EventType, handler: (e: BoardEvent) => void) {\n    this._eventEmitter.on(event, handler)\n  }\n  public trigger(event: EventType, e: BoardEvent) {\n    this._eventEmitter.trigger(event, [e])\n  }\n\n  // original events\n  protected handleMouseDown(e: MouseEvent) {\n    this.mouseStartX = e.clientX - this.boardX\n    this.mouseStartY = e.clientY - this.boardY\n\n    this._cachedEvent.originEvent = e\n    this._cachedEvent.customData || (this._cachedEvent.customData = {})\n    this._cachedEvent.customData.x = this.mouseStartX\n    this._cachedEvent.customData.y = this.mouseStartY\n    this._eventEmitter.trigger(EventType.MouseDown, [this._cachedEvent])\n  }\n  protected handleMouseMove(e: MouseEvent) {\n    let [x, y] = [e.clientX - this.boardX, e.clientY - this.boardY]\n    this._cachedEvent.originEvent = e\n\n    this._cachedEvent.customData || (this._cachedEvent.customData = {})\n    this._cachedEvent.customData.x = x\n    this._cachedEvent.customData.y = y\n    this._eventEmitter.trigger(EventType.MouseMove, [this._cachedEvent])\n  }\n  protected handleMouseUp(e: MouseEvent) {\n    this._cachedEvent.originEvent = e\n    this._cachedEvent.customData.x = e.clientX - this.boardX\n    this._cachedEvent.customData.y = e.clientY - this.boardY\n    this._eventEmitter.trigger(EventType.MouseUp, [this._cachedEvent])\n  }\n  protected handleClick(e: MouseEvent) {}\n  protected handleDBClick(e: MouseEvent) {}\n  protected handleKeyDown(e: KeyboardEvent) {\n    this._cachedKeyEvent.originEvent = e\n    this.trigger(EventType.KeyDown, this._cachedKeyEvent)\n  }\n  protected handleResize(e) {\n    this.updateBoardPosition()\n    this.curConfig.dimensions = this.getTargetDimensions()\n    this.updateBoardSize()\n  }\n\n  // custom events\n  private onMouseDown(e: BoardEvent) {\n    console.log(\"function onMouseDown...\")\n    this.MouseDown = true\n\n    if (this.currentMode === EditorMode.CREATE) {\n      this._cachedEvent.customData = {\n        type: this.currentCreateMode,\n        startX: this.mouseStartX,\n        startY: this.mouseStartY,\n      }\n      this._eventEmitter.trigger(EventType.CreateStart, [this._cachedEvent])\n      return\n    }\n    console.log(\"not create mode...\")\n    if (this.mouseStatusManager.mouseStatus == MouseStatus.ROTATE) {\n      this.setMode(EditorMode.ROTATE)\n      return\n    }\n    console.log(\"not rotate mode...\")\n    if (this.mouseStatusManager.mouseStatus == MouseStatus.SCALE) {\n      this.setMode(EditorMode.SCALE)\n      return\n    }\n    console.log(\"not scale mode...\")\n    // 若点击在选中物体范围内则进入拖拽模式(enter drag mode if mouse down on the selected area)\n    if (\n      this.selection &&\n      this.selection.length >= 1 &&\n      this.clickOnSelectedArea(e)\n    ) {\n      this.setMode(EditorMode.DRAG)\n    } else {\n      if (\n        this.clickOnElement(new Vector2(this.mouseStartX, this.mouseStartY))\n      ) {\n        this.setMode(EditorMode.DRAG)\n      } else {\n        this.setMode(EditorMode.SELECT)\n        this._eventEmitter.trigger(EventType.SelectStart, [this._cachedEvent])\n      }\n    }\n  }\n  private onMouseMove(e: BoardEvent) {\n    if (this.currentMode === EditorMode.CREATE && this.MouseDown) {\n      this._cachedEvent.customData = {\n        startX: this.mouseStartX,\n        startY: this.mouseStartY,\n        endX: e.customData.x,\n        endY: e.customData.y,\n      }\n      this._eventEmitter.trigger(EventType.Creating, [this._cachedEvent])\n    } else if (this.currentMode == EditorMode.DRAG) {\n      this._cachedEvent.customData = {\n        startX: this.mouseStartX,\n        startY: this.mouseStartY,\n        endX: e.customData.x,\n        endY: e.customData.y,\n      }\n      this._eventEmitter.trigger(EventType.Draging, [this._cachedEvent])\n    } else if (this.currentMode == EditorMode.ROTATE) {\n      this._cachedEvent.customData = {\n        startX: this.mouseStartX,\n        startY: this.mouseStartY,\n        endX: e.customData.x,\n        endY: e.customData.y,\n      }\n      this._eventEmitter.trigger(EventType.Rotating, [this._cachedEvent])\n    } else if (this.currentMode == EditorMode.SCALE) {\n      this._cachedEvent.customData = {\n        startX: this.mouseStartX,\n        startY: this.mouseStartY,\n        endX: e.customData.x,\n        endY: e.customData.y,\n      }\n      this._eventEmitter.trigger(EventType.Scaling, [this._cachedEvent])\n    } else if (this.MouseDown) {\n      this._cachedEvent.customData = {\n        startX: this.mouseStartX,\n        startY: this.mouseStartY,\n        endX: e.customData.x,\n        endY: e.customData.y,\n      }\n      this._eventEmitter.trigger(EventType.Selecting, [this._cachedEvent])\n    }\n  }\n  private onMouseUp(e: BoardEvent) {\n    this.MouseDown = false\n    if (this.currentMode === EditorMode.CREATE) {\n      this._eventEmitter.trigger(EventType.CreateEnd, [this._cachedEvent])\n    } else if (this.currentMode == EditorMode.SELECT) {\n      this._eventEmitter.trigger(EventType.SelectEnd, [this._cachedEvent])\n    } else if (this.currentMode == EditorMode.ROTATE) {\n      this._eventEmitter.trigger(EventType.RotateEnd, [this._cachedEvent])\n    } else if (this.currentMode == EditorMode.DRAG) {\n      this._eventEmitter.trigger(EventType.DragEnd, [this._cachedEvent])\n    } else if (this.currentMode == EditorMode.SCALE) {\n      this._eventEmitter.trigger(EventType.ScaleEnd, [this._cachedEvent])\n    }\n    this.currentMode = EditorMode.SELECT\n  }\n\n  private onSelectStart(e: BoardEvent) {}\n  private onSelectMove(e: BoardEvent) {}\n  private onSelectEnd(e: BoardEvent) {}\n\n  private onCreateElement(e: BoardEvent) {\n    const { originEvent: mouseEvent, customData } = e\n    switch (customData.type) {\n      case CreateMode.RECT:\n        let rect = new Rect(customData.startX, customData.startY, 0, 0)\n        this.svgcontent.append(rect.domInstance)\n        this.elements.push(rect)\n        this.setSelected([rect])\n        break\n      case CreateMode.ELLIPSE:\n        let ellipse = new ELLIPSE(customData.startX, customData.startY, 0, 0)\n        this.svgcontent.append(ellipse.domInstance)\n        this.elements.push(ellipse)\n        this.setSelected([ellipse])\n        break\n      default:\n        Log.Error(\"error insert mode\")\n    }\n  }\n  private onCreateMove(e: BoardEvent) {\n    this.updateSelectionArea()\n    if (this.container.className) this.container.className = \"\"\n    const { originEvent: mouseEvent, customData } = e\n    let [width, height] = [\n      Math.abs(customData.endX - customData.startX),\n      Math.abs(customData.endY - customData.startY),\n    ]\n    // 元素的实际位置和大小由 Box（0，0，1，1）与 transform 结合表示\n    this.selection[0].transform.a = width\n    this.selection[0].transform.d = height\n    this.selection[0].transform.e = Math.min(customData.endX, customData.startX)\n    this.selection[0].transform.f = Math.min(customData.endY, customData.startY)\n    this.selection[0].updateRendering()\n  }\n  private onCreateEnd(e: BoardEvent) {\n    console.log(\"create element end...\")\n  }\n  private onDragStart(e: BoardEvent) {\n    e.elements = this.selection\n    this.trigger(EventType.ElementChangeStart, e)\n    this.selectionTransforms = this.selection.map((n) => n.transform.clone())\n    this.selection.forEach((e) => (e.lastTransform = e.transform.clone()))\n  }\n  private onDraging(e: BoardEvent) {\n    const { originEvent: mouseEvent, customData } = e\n    const { startX, startY, endX, endY } = customData\n    // @todo: 需要记录 drag 之前的 transform 信息\n    this.selection.forEach((n, index) => {\n      n.transform.e = this.selectionTransforms[index].e + endX - startX\n      n.transform.f = this.selectionTransforms[index].f + endY - startY\n      n.updateRendering()\n    })\n    this.updateSelectionArea()\n  }\n  private onDragEnd(e: BoardEvent) {\n    e.elements = this.selection\n    this.trigger(EventType.ElementChangeEnd, e)\n  }\n\n  private onRotateStart(e: BoardEvent) {\n    e.elements = this.selection\n    this.trigger(EventType.ElementChangeStart, e)\n    this.selectionTransforms = this.selection.map((n) => n.transform.clone())\n    this.lastSelectionArea = this.selectionArea.clone()\n  }\n  private onRotating(e: BoardEvent) {\n    const { originEvent: mouseEvent, customData } = e\n    const { startX, startY, endX, endY } = customData\n    let center = this.lastSelectionArea.center()\n    let a = new Vector2(startX - center.x, startY - center.y)\n    let b = new Vector2(endX - center.x, endY - center.y)\n    let theta = a.angle(b)\n    let flag = a.crossMultiply(b)\n\n    theta = flag > 0 ? theta : Math.PI * 2 - theta\n    this.selection.forEach((n, index) => {\n      n.transform.copy(\n        this.selectionTransforms[index].clone().rotate(theta, center)\n      )\n      n.updateRendering()\n    })\n    this.updateSelectionArea()\n  }\n  private onRotateEnd(e: BoardEvent) {\n    e.elements = this.selection\n    this.trigger(EventType.ElementChangeEnd, e)\n    this.updateSelectionArea()\n  }\n\n  private onScaleStart(e: BoardEvent) {\n    e.elements = this.selection\n    this.trigger(EventType.ElementChangeStart, e)\n\n    this.lastFrameWidth = this.selection[0].frameWidth\n    this.lastFrameHeight = this.selection[0].frameHeight\n    this.selectionTransforms = this.selection.map((n) => n.transform.clone())\n    this.lastSelectionArea = this.selectionArea.clone()\n    let fx = 1\n    let fy = 1\n    switch (this.mouseStatusManager.cornerType) {\n      default:\n      case DIRECTION.RB:\n        break\n      case DIRECTION.RT:\n        fy = -1\n        break\n      case DIRECTION.LB:\n        fx = -1\n        break\n      case DIRECTION.LT:\n        fx = fy = -1\n        break\n    }\n    this.fx = fx\n    this.fy = fy\n  }\n  private onScaling(e: BoardEvent) {\n    const { originEvent: mouseEvent, customData } = e\n    const { startX, startY, endX, endY } = customData\n    let start = new Vector2(startX, startY)\n    let end = new Vector2(endX, endY)\n\n    let fx = this.fx\n    let fy = this.fy\n\n    // @todo: 待优化，这里看下怎么复用下两种情况下的代码\n    if (this.selection.length == 1) {\n      let n = this.selection[0]\n      let a = start\n        .clone()\n        .applyTransform(this.selectionTransforms[0].inverse())\n      let b = end.clone().applyTransform(this.selectionTransforms[0].inverse())\n      b.subtract(a)\n\n      // avoid the value become 0\n      let [x, y] = [fx * b.x + 1, fy * b.y + 1]\n      let [absx, absy] = [\n        Math.max(Math.abs(x), 0.001),\n        Math.max(Math.abs(y), 0.001),\n      ]\n      x = x < 0 ? -absx : absx\n      y = y < 0 ? -absy : absy\n      n.transform.copy(\n        this.selectionTransforms[0]\n          .clone()\n          .scale(x, y, new Vector2(fx == -1 ? 1 : 0, fy == -1 ? 1 : 0))\n      )\n      n.updateRendering()\n    } else {\n      // 以下只适合多选\n      let [tw, th] = [\n        this.lastSelectionArea.box.w,\n        this.lastSelectionArea.box.h,\n      ]\n      let v = end.subtract(start)\n      let [x, y] = [(fx * v.x) / tw + 1, (fy * v.y) / th + 1]\n      let [absx, absy] = [\n        Math.max(Math.abs(x), 0.001),\n        Math.max(Math.abs(y), 0.001),\n      ]\n      x = x < 0 ? -absx : absx\n      y = y < 0 ? -absy : absy\n      let box = this.lastSelectionArea.box\n      let rotateCenter = new Vector2(box.x, box.y).add(\n        new Vector2(fx == -1 ? box.w : 0, fy == -1 ? box.h : 0)\n      )\n\n      this.selection.forEach((n, index) => {\n        n.transform.copy(\n          this.selectionTransforms[index].clone().scale2(x, y, rotateCenter)\n        )\n        n.updateRendering()\n      })\n    }\n    this.updateSelectionArea()\n  }\n  private onScaleEnd(e: BoardEvent) {\n    e.elements = this.selection\n    this.trigger(EventType.ElementChangeEnd, e)\n    this.updateSelectionArea()\n  }\n\n  private onChangeMode(e: BoardEvent) {\n    const { customData } = e\n    console.log(\"change mode:\", customData.mode)\n    if (customData.mode === EditorMode.SELECT) {\n      this.setSelected([])\n    } else if (this.currentMode === EditorMode.CREATE) {\n      this.container.className = \"cursor-crosshair\"\n    } else if (this.currentMode == EditorMode.DRAG) {\n      this._cachedEvent.customData = {\n        transforms: this.selectionTransforms,\n      }\n      this._eventEmitter.trigger(EventType.DragStart, [this._cachedEvent])\n    } else if (this.currentMode == EditorMode.ROTATE) {\n      this._cachedEvent.customData = {\n        transforms: this.selectionTransforms,\n      }\n      this._eventEmitter.trigger(EventType.RotateStart, [this._cachedEvent])\n    } else if (this.currentMode == EditorMode.SCALE) {\n      this._cachedEvent.customData = {\n        transforms: this.selectionTransforms,\n      }\n      this._eventEmitter.trigger(EventType.ScaleStart, [this._cachedEvent])\n    }\n  }\n\n  private onElementChanged(e: BoardEvent) {\n    this.updateSelectionArea()\n  }\n\n  private onMouseStatusChange(e: BoardEvent) {}\n\n  // judge\n  private clickOnSelectedArea(e: BoardEvent) {\n    return this.selectionArea.include(\n      new Vector2(e.customData.x, e.customData.y)\n    )\n  }\n\n  private clickOnElement(pos) {\n    // @todo: 给每个元素设置一个 Area 属性\n    let element = this.elements\n      .sort((a, b) => (a.zIndex > b.zIndex ? 1 : -1))\n      .find((e) => {\n        return new Area(new Box(0, 0, 1, 1), e.transform).include(pos)\n      })\n    this.setSelected(element ? [element] : [])\n    return !!element\n  }\n}\n\nexport enum EditorMode {\n  SELECT = \"SELECT\",\n  DRAG = \"DRAG\",\n  ROTATE = \"ROTATE\",\n  SCALE = \"SCALE\",\n  CREATE = \"CREATE\",\n  DRAW = \"DRAW\",\n}\n\nexport enum CreateMode {\n  RECT = \"RECT\",\n  ELLIPSE = \"ELLIPsE\",\n  LINE = \"LINE\",\n}\n\nexport enum ResizeMode {\n  CASUAL,\n  SCALE,\n}\n\nexport enum MouseStatus {\n  SELECT = \"SELECT\",\n  DRAG = \"DRAG\",\n  SCALE = \"SCALE\",\n  ROTATE = \"ROTATE\",\n}\n\nexport enum DIRECTION {\n  LT,\n  LM,\n  LB,\n  CT,\n  CM,\n  CB,\n  RT,\n  RM,\n  RB,\n}\n","import { BaseElement } from \"./BaseElement\"\nimport { Board } from \"./Board\"\nimport { BoardEvent, EventType } from \"./EventEmitter\"\nimport { Log } from \"./Log\"\nimport { Manager } from \"./Manager\"\nimport { Transform } from \"./Transform\"\n\nexport class Command {\n  public apply() {}\n  public unApply() {}\n}\n\nexport class CreateElementCommand extends Command {}\nexport class ChangeElementCommand extends Command {\n  element: BaseElement\n  oldValues: any\n  newValues: any\n  info: string\n  constructor(element: BaseElement, attrs: any, info: string) {\n    super()\n    this.element = element\n    this.oldValues = attrs\n    this.newValues = { transform: element.transform.clone() }\n    this.info = info ? info : \"\"\n  }\n\n  public apply(): void {\n    Object.entries(this.newValues).forEach(([key, value]) => {\n      switch (key) {\n        case \"transform\":\n          this.element.transform = value as Transform\n\n          break\n      }\n    })\n    this.element.updateRendering()\n  }\n  public unApply(): void {\n    Object.entries(this.oldValues).forEach(([key, value]) => {\n      console.log(key, value)\n      switch (key) {\n        case \"transform\":\n          this.element.transform = value as Transform\n\n          break\n      }\n    })\n    this.element.updateRendering()\n  }\n}\n\nexport class BatchCommand extends Command {\n  stack: Command[]\n  info: string\n  constructor(info) {\n    super()\n    this.stack = []\n    this.info = info ? info : \"\"\n  }\n\n  public apply(): void {\n    this.stack.forEach((cmd) => cmd && cmd.apply())\n  }\n  public unApply(): void {\n    console.log(this.stack)\n    this.stack.reverse().forEach((cmd) => cmd && cmd.unApply())\n  }\n  public addSubCommand(cmd: Command) {\n    this.stack.push(cmd)\n  }\n}\n\ntype UndoableChange = {\n  attr: string\n  oldValues: Transform[]\n  elements: BaseElement[]\n}\n\nexport class UndoManager extends Manager {\n  undoStackPointer: number\n  stack: Command[]\n  undoChangeStackPointer: number\n  undoableChangeStack: UndoableChange[]\n  constructor(board: Board) {\n    super(board)\n\n    this.stack = []\n    this.undoStackPointer = 0\n    this.undoableChangeStack = []\n    this.undoChangeStackPointer = -1\n\n    // this.board.on(EventType.DragStart, this.onDragStart.bind(this))\n    // this.board.on(EventType.DragEnd, this.onDragEnd.bind(this))\n    this.board.on(\n      EventType.ElementChangeStart,\n      this.onElementChangeStart.bind(this)\n    )\n    this.board.on(\n      EventType.ElementChangeEnd,\n      this.onElementChangeEnd.bind(this)\n    )\n    this.board.on(EventType.Undo, this.onUndo.bind(this))\n    this.board.on(EventType.Redo, this.onRedo.bind(this))\n  }\n\n  private onElementChangeStart(e: BoardEvent) {\n    this.startUndoableChange(\"transform\", this.board.selection)\n  }\n\n  private onElementChangeEnd(e: BoardEvent) {\n    let batchCmd = this.endUndoableChange()\n    if (batchCmd) {\n      this.addCommandToHistory(batchCmd)\n      console.log(this.stack)\n    }\n  }\n\n  private onUndo(e: BoardEvent) {\n    if (this.undoStackPointer > 0) {\n      let cmd = this.stack[--this.undoStackPointer]\n      cmd.unApply()\n      this.board.trigger(EventType.ElementChanged, e)\n    } else {\n      Log.Warn(\"no action to apply undo..\")\n    }\n  }\n\n  private onRedo(e: BoardEvent) {\n    // todo: finish this\n    console.log(\"on redo\")\n    console.log(this.undoStackPointer)\n    console.log(this.stack)\n    if (this.undoStackPointer < this.stack.length && this.stack.length > 0) {\n      const cmd = this.stack[this.undoStackPointer++]\n      cmd.apply()\n      this.board.trigger(EventType.ElementChanged, e)\n    }\n  }\n\n  private addCommandToHistory(cmd: Command) {\n    if (this.undoStackPointer < this.stack.length && this.stack.length > 0) {\n      this.stack = this.stack.splice(0, this.undoStackPointer)\n    }\n    this.stack.push(cmd)\n    this.undoStackPointer = this.stack.length\n  }\n\n  private startUndoableChange(attr: string, elements: BaseElement[]) {\n    const p = ++this.undoChangeStackPointer\n    const oldValues = elements.map((e) => e.transform.clone())\n    this.undoableChangeStack[p] = {\n      attr,\n      oldValues,\n      elements,\n    }\n  }\n  private endUndoableChange() {\n    const p = this.undoChangeStackPointer--\n    const changeset = this.undoableChangeStack[p]\n    const { attr, elements } = changeset\n\n    const batchCmd = new BatchCommand(\"change elements\")\n    elements.forEach((element, i) => {\n      let changes: Partial<UndoableChange> = {}\n      changes[attr] = changeset.oldValues[i]\n      if (!changes[attr].equal(element.transform)) {\n        batchCmd.addSubCommand(new ChangeElementCommand(element, changes, attr))\n      }\n    })\n    this.undoableChangeStack[p] = null\n    return batchCmd\n  }\n}\n","import { Board, DIRECTION, MouseStatus } from \"./Board\"\nimport { BoardEvent, EventType } from \"./EventEmitter\"\nimport { Log } from \"./Log\"\nimport { Manager } from \"./Manager\"\nimport { Vector2 } from \"./Vector\"\n\nexport class MouseStatusManager extends Manager {\n  private _mouseStatus: MouseStatus\n  private _cachedEvent: BoardEvent\n\n  private _cornerType: DIRECTION\n  public get cornerType(): DIRECTION {\n    return this._cornerType\n  }\n  public set cornerType(value: DIRECTION) {\n    this._cornerType = value\n  }\n\n  public get mouseStatus(): MouseStatus {\n    return this._mouseStatus\n  }\n  public set mouseStatus(value: MouseStatus) {\n    if (this._mouseStatus === value) return\n    // console.log(this._mouseStatus)\n    this._mouseStatus = value\n    this._cachedEvent.customData.mouseStatus = value\n    this.eventEmitter.trigger(EventType.MouseStatusChange, [this._cachedEvent])\n  }\n\n  constructor(board: Board) {\n    super(board)\n\n    this._cachedEvent = new BoardEvent(\"mouseStatusChange\", null)\n    this._cachedEvent.customData = {}\n\n    this.eventEmitter.on(\n      EventType.MouseStatusChange,\n      this.onMouseStatusChange.bind(this)\n    )\n  }\n\n  public override onMouseDown(e: BoardEvent): void {}\n  public override onMouseMove(e: BoardEvent): void {\n    this.updateMouseStatus(e)\n  }\n  public override onMouseUp(e: BoardEvent): void {}\n\n  private onMouseStatusChange(e: BoardEvent) {\n    const { customData } = e\n    switch (customData.mouseStatus) {\n      default:\n      case MouseStatus.DRAG:\n        this.board.container.className = \"\"\n        break\n      case MouseStatus.ROTATE:\n        this.board.container.className = \"cursor-rotate\"\n        break\n      case MouseStatus.SCALE:\n        this.board.container.className = \"cursor-resize\"\n        break\n    }\n  }\n\n  private updateMouseStatus(e: BoardEvent) {\n    if (!this.board.selection || this.board.selection.length < 1) return false\n    let { x, y } = e.customData\n    let distances = this.board.selectionArea.nearestCornerDistance(\n      new Vector2(x, y)\n    )\n    let dis = Infinity,\n      index = -1\n    distances.forEach((d, i) => {\n      if (d < dis) {\n        dis = d\n        index = i\n      }\n    })\n    switch (index) {\n      case 0:\n        this.cornerType = DIRECTION.LT\n        break\n      case 1:\n        this.cornerType = DIRECTION.LB\n        break\n      case 2:\n        this.cornerType = DIRECTION.RB\n        break\n      case 3:\n        this.cornerType = DIRECTION.RT\n        break\n    }\n\n    if (dis < 5) {\n      this.mouseStatus = MouseStatus.SCALE\n    } else if (dis < 10) {\n      this.mouseStatus = MouseStatus.ROTATE\n      // @todo: finish this\n    } else if (false) {\n      this.mouseStatus = MouseStatus.DRAG\n    } else {\n      this.mouseStatus = MouseStatus.SELECT\n    }\n  }\n}\n","import { Board, CreateMode, EditorMode } from \"./Board\"\nimport { BoardEvent, EventType } from \"./EventEmitter\"\nimport { Manager } from \"./Manager\"\nimport { isMac } from \"./utilities\"\n\nexport class ShortcutManager extends Manager {\n  constructor(board: Board) {\n    super(board)\n\n    this.board.eventEmitter.on(EventType.KeyDown, this.OnKeyDown.bind(this))\n  }\n\n  public OnKeyDown(e: BoardEvent) {\n    let originEvent = e.originEvent as KeyboardEvent\n    let isMacOS = isMac()\n    switch (originEvent.key) {\n      case \"r\":\n        this.board.setMode(EditorMode.CREATE)\n        this.board.currentCreateMode = CreateMode.RECT\n        break\n      case \"o\":\n        this.board.setMode(EditorMode.CREATE)\n        this.board.currentCreateMode = CreateMode.ELLIPSE\n        break\n      case \"l\":\n        this.board.setMode(EditorMode.CREATE)\n        this.board.currentCreateMode = CreateMode.LINE\n        break\n      case \"v\":\n        this.board.setMode(EditorMode.SELECT)\n        this.board.currentCreateMode = CreateMode.LINE\n        break\n      case \"z\":\n        // 需要判断一下平台\n        let ctrlOrCmd =\n          (isMacOS && originEvent.metaKey) || (!isMacOS && originEvent.ctrlKey)\n        if (ctrlOrCmd) {\n          if (originEvent.shiftKey) {\n            this.board.trigger(EventType.Redo, e)\n          } else {\n            this.board.trigger(EventType.Undo, e)\n          }\n        }\n        break\n    }\n  }\n}\n","\n      import API from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../node_modules/css-loader/dist/cjs.js!./index.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../node_modules/css-loader/dist/cjs.js!./index.css\";\n       export default content && content.locals ? content.locals : undefined;\n","import { Board } from \"./svgBoard\"\nimport \"./index.css\"\nconsole.log(\"entry index.ts\")\n\nlet board = new Board(document.body)\n"],"names":["___CSS_LOADER_EXPORT___","push","module","id","exports","cssWithMappingToString","list","toString","this","map","item","content","needLayer","concat","length","join","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","k","_k","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","stylesInDOM","getIndexByIdentifier","identifier","result","modulesToDom","options","idCountMap","identifiers","base","count","indexByIdentifier","obj","css","sourceMap","references","updater","addElementStyle","byIndex","splice","api","domAPI","update","newObj","remove","lastIdentifiers","newList","index","newLastIdentifiers","_i","_index","memo","insert","style","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","getTarget","Error","appendChild","element","createElement","setAttributes","attributes","styleElement","nonce","setAttribute","insertStyleElement","styleTagTransform","apply","parentNode","removeChild","removeStyleElement","styleSheet","cssText","firstChild","createTextNode","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","call","nc","EventType","x","y","_x","_y","value","Math","sqrt","ones","Vector2","zeros","add","v","subtract","dotMultiply","crossMultiply","angle","acos","min","mod","distance","pow","rotateAtOrigin","theta","cos","sin","applyTransform","transform","b","c","f","opposite","clone","w","h","_w","_h","set","box","set4","setSize","Box","merge","mergeAll","boxes","minx","maxx","max","miny","center","toVector2","y2","x2","t","PI","Transform","fromAngle","rotation","identity","from","setFromArray","arr","copy","reset","equal","translate","translate2","radius","sina","cosa","rightMultiply","rotate","p","scale","scaleAtOrigin","scale2","scale2AtOrigin","flipY","x1","tm","leftMultiply","inverse","detA","cssString","tranform","_box","_transform","Area","include","pp","nearestCornerDistance","NS","generateSvgElement","docuemnt","ele","createElementNS","keys","forEach","setAttr","attr","isMac","agent","navigator","userAgent","toLowerCase","test","callbacks","on","name","callback","console","warn","off","Array","trigger","_args","args","event","originEvent","elements","_elements","_name","_originEvent","_customData","board","AABB","area","zIndex","eventEmitter","CreateStart","onCreateStart","bind","Creating","onCreating","CreateEnd","onCreateEnd","_id","_area","_domInstance","createDomInstance","_lastTransform","_AABB","_zIndex","_points","selection","updatePoints","corners","points","updateAABB","minX","minY","maxX","maxY","Default","width","height","cx","cy","rx","ry","fill","updateAttr","updateRendering","BaseElement","frameWidth","frameHeight","MouseDown","onMouseDown","MouseMove","onMouseMove","MouseUp","onMouseUp","container","svgroot","selectorRoot","svgdoc","selectRect","activeGroup","append","activeMap","Map","manuplator","display","manuplatorRect","stroke","manuplatorPoints","point","lastSelectedNum","selectArea","SelectStart","onSelectStart","Selecting","onSelectMove","SelectEnd","onSelectEnd","ElementSelected","onElemetSelected","NothingSelected","onNothingSelected","Draging","onDraging","Rotating","onRotating","Scaling","onScaling","ElementChanged","onElementChanged","customData","startX","endX","startY","endY","abs","selected","find","setSelected","updateRender","onDragStart","onElementCreateing","rect","updateSelector","clear","has","ps","pathStr","children","generatePathStr","selectionArea","Manager","EditorMode","CreateMode","ResizeMode","MouseStatus","DIRECTION","message","error","Warn","Info","info","blue","red","_cachedEvent","BoardEvent","MouseStatusChange","onMouseStatusChange","_cornerType","_mouseStatus","mouseStatus","updateMouseStatus","DRAG","className","ROTATE","SCALE","distances","dis","Infinity","cornerType","LT","LB","RB","RT","SELECT","KeyDown","OnKeyDown","isMacOS","setMode","CREATE","currentCreateMode","RECT","ELLIPSE","LINE","metaKey","ctrlKey","shiftKey","Redo","Undo","unApply","Command","attrs","oldValues","newValues","entries","log","stack","cmd","reverse","addSubCommand","undoStackPointer","undoableChangeStack","undoChangeStackPointer","ElementChangeStart","onElementChangeStart","ElementChangeEnd","onElementChangeEnd","onUndo","onRedo","startUndoableChange","batchCmd","endUndoableChange","addCommandToHistory","Log","changeset","BatchCommand","changes","ChangeElementCommand","boardX","boardY","mouseStartX","mouseStartY","lastZIndex","saveOptions","plugins","currentMode","currentResizeMode","CASUAL","rubberBox","curBBoxes","curConfig","dimensions","getTargetDimensions","selectionTransforms","_eventEmitter","EventEmitter","initEventHandler","initCustomEventHandler","_cachedKeyEvent","mouseStatusManager","MouseStatusManager","undoManager","UndoManager","shotcutManager","ShortcutManager","updateBoardPosition","svgAttributs","xmlns","xlinks","overflow","bgAttributes","canvasBg","_svgdoc","rectAttributes","svgcontent","addInstructions","initSelector","_selection","_selectionArea","_container","_currentCreateMode","_svgroot","innerWidth","innerHeight","updateBoardSize","instruction","texts","innerHTML","selector","Selector","addEventListener","handleMouseDown","handleMouseUp","handleClick","handleDBClick","handleMouseMove","handleResize","handleKeyDown","onCreateElement","onCreateMove","ChangeMode","onChangeMode","DragStart","DragEnd","onDragEnd","RotateStart","onRotateStart","RotateEnd","onRotateEnd","ScaleStart","onScaleStart","ScaleEnd","onScaleEnd","bbox","getBoundingClientRect","exportSvg","eventType","updateSelectionArea","mode","handler","clientX","clientY","type","clickOnSelectedArea","clickOnElement","Rect","domInstance","ellipse","lastTransform","lastSelectionArea","flag","lastFrameWidth","lastFrameHeight","fx","fy","start","end","absx","absy","tw","th","transforms","pos","sort","idPrefix","Board","body"],"sourceRoot":""}